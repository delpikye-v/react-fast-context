"use strict";var t=require("react");exports.bindActions=function(t,e){const n={};for(const r in t){const o=t[r];n[r]=(...t)=>{e(e=>{o(e,...t)})}}return n},exports.bindFastContext=function(t){return function(e,n,r){var o;const c=null!==(o=r.signal)&&void 0!==o?o:(new AbortController).signal;return{payload:e,scope:n,emit:r.emit,signal:c,state:t.get(),setState(e){t.set(e)}}}},exports.createFastContext=function(e){var n;const r=createStore(e.state,{merge:null!==(n=e.merge)&&void 0!==n?n:"shallow"}),o=e.actions?bindActions(e.actions,r.set):void 0;return{get state(){return r.get()},set:r.set,replace:r.replace,batch:r.batch,transaction:r.transaction,subscribe:r.subscribe,devtools:function(t){return r.subscribe(()=>t({state:r.get()}))},use:function(e){return t.useSyncExternalStore(r.subscribe,()=>{const t=r.get();return e?e(t):t},()=>{const t=r.get();return e?e(t):t})},actions:o}},exports.createFastSelector=function(e,n){return function(r,o=Object.is){const c=t.useRef(),s=t.useRef(!1),u=()=>{const t=r(e());return s.current&&o(c.current,t)?c.current:(s.current=!0,c.current=t,t)};return t.useSyncExternalStore(n,u,u)}},exports.createStore=function(t,e){var n;let r=t;const o=new Set,c=null!==(n=null==e?void 0:e.merge)&&void 0!==n?n:"shallow";let s=!1,u=!1;function i(){s?u=!0:o.forEach(t=>t())}return{get:function(){return r},set:function(t){const e=r,n=structuredClone(r);t(n),r=function(t,e){if("none"===c)return e;const n=structuredClone(e);for(const e in n){const r=t[e],o=n[e];r&&o&&"object"==typeof r&&"object"==typeof o&&!Array.isArray(r)&&!Array.isArray(o)&&"shallow"===c&&(n[e]={...r,...o})}return n}(e,n),i()},replace:function(t){r=t,i()},batch:function(t){s=!0,t(),s=!1,u&&(u=!1,i())},transaction:function(t){const e=r,n=s,o=u;s=!0,u=!1;try{t(),s=n,!n&&u&&(u=!1,i())}catch(t){throw r=e,s=n,u=o,t}},subscribe:function(t){return o.add(t),()=>o.delete(t)}}};
