"use strict";var t=require("react");function e(t,e){var n;let r=t;const o=new Set,c=null!==(n=null==e?void 0:e.merge)&&void 0!==n?n:"shallow";let s=!1,u=!1;function i(){s?u=!0:o.forEach(t=>t())}return{get:function(){return r},set:function(t){const e=r,n=structuredClone(e);t(n),r=function(t,e){if("none"===c)return e;const n=structuredClone(e);for(const e in n){const r=t[e],o=n[e];r&&o&&"object"==typeof r&&"object"==typeof o&&!Array.isArray(r)&&!Array.isArray(o)&&"shallow"===c&&(n[e]={...r,...o})}return n}(e,n),i()},replace:function(t){r=t,i()},batch:function(t){s=!0,t(),s=!1,u&&(u=!1,i())},transaction:function(t){const e=r,n=s,o=u;s=!0,u=!1;try{t(),s=n,!n&&u&&(u=!1,i())}catch(t){throw r=e,s=n,u=o,t}},subscribe:function(t){return o.add(t),()=>o.delete(t)}}}function n(t,e){const n={};for(const r in t){const o=t[r];n[r]=(...t)=>{e(e=>{o(e,...t)})}}return n}function r(e,n){return function(r,o=Object.is){const c=t.useRef(),s=t.useRef(!1),u=()=>{const t=r(e());return s.current&&o(c.current,t)?c.current:(s.current=!0,c.current=t,t)};return t.useSyncExternalStore(n,u,u)}}exports.bindActions=n,exports.bindFastContext=function(t){return function(e,n,r){var o;const c=null!==(o=r.signal)&&void 0!==o?o:(new AbortController).signal;return{payload:e,scope:n,emit:r.emit,signal:c,state:t.get(),setState(e){t.set(e)}}}},exports.createFastContext=function t(o){var c;const s=e(o.state,{merge:null!==(c=o.merge)&&void 0!==c?c:"shallow"}),u=r(s.get,s.subscribe);function i(t,e){let n=t(s.get());return{use:()=>u(t,e),value:()=>t(s.get()),subscribe:function(r){return s.subscribe(()=>{const o=t(s.get());(e?e(n,o):o===n)||(n=o,r(o))})}}}const a=o.actions?n(o.actions,s.set):void 0;return{state:s.get,set:s.set,replace:s.replace,batch:s.batch,transaction:s.transaction,subscribe:s.subscribe,when:function(t,e){let n=!1;return s.subscribe(()=>{if(n)return;const r=s.get(),o=t(r);o&&(n=!0,e(o,r))})},devtools:function(t){return s.subscribe(()=>t({state:s.get()}))},computed:i,select:i,scope:function(e,n){return t({state:e,actions:o.actions,merge:null==n?void 0:n.merge})},use:u,actions:a}},exports.createFastSelector=r,exports.createStore=e;
